B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=8.31
@EndOfDesignText@
'Custom BANano View class: VBtn
#IgnoreWarnings:12
#Event: click (argument As BANanoEvent)


#DesignerProperty: Key: Text, DisplayName: Text, FieldType: String, DefaultValue: , Description: Text on the label 
#DesignerProperty: Key: VText, DisplayName: VText, FieldType: String, DefaultValue: , Description: VText 
#DesignerProperty: Key: VHtml, DisplayName: VHtml, FieldType: String, DefaultValue: , Description: VHtml 
#DesignerProperty: Key: VModel, DisplayName: VModel, FieldType: String, DefaultValue: , Description: VModel 
#DesignerProperty: Key: RefName, DisplayName: RefName, FieldType: String, DefaultValue: , Description: RefName 
#DesignerProperty: Key: VIf, DisplayName: VIf, FieldType: String, DefaultValue: , Description: VIf 
#DesignerProperty: Key: VElse, DisplayName: VElse, FieldType: String, DefaultValue: , Description: VElse 
#DesignerProperty: Key: VShow, DisplayName: VShow, FieldType: String, DefaultValue: , Description: VShow 
#DesignerProperty: Key: VFor, DisplayName: VFor, FieldType: String, DefaultValue: , Description: VFor 
#DesignerProperty: Key: KeyName, DisplayName: KeyName, FieldType: String, DefaultValue: , Description: KeyName
#DesignerProperty: Key: Absolute, DisplayName: Absolute, FieldType: Boolean, DefaultValue: false , Description: Set absolute
#DesignerProperty: Key: ActiveClass, DisplayName: ActiveClass, FieldType: String, DefaultValue: , Description: Set active-class
#DesignerProperty: Key: Append, DisplayName: Append, FieldType: Boolean, DefaultValue: false , Description: Set append
#DesignerProperty: Key: Block, DisplayName: Block, FieldType: Boolean, DefaultValue: false , Description: Set block
#DesignerProperty: Key: Bottom, DisplayName: Bottom, FieldType: Boolean, DefaultValue: false , Description: Set bottom
#DesignerProperty: Key: Color, DisplayName: Color, FieldType: String, DefaultValue: , Description: Set color
#DesignerProperty: Key: Dark, DisplayName: Dark, FieldType: Boolean, DefaultValue: false , Description: Set dark
#DesignerProperty: Key: Depressed, DisplayName: Depressed, FieldType: Boolean, DefaultValue: false , Description: Set depressed
#DesignerProperty: Key: Disabled, DisplayName: Disabled, FieldType: Boolean, DefaultValue: false , Description: Set disabled
#DesignerProperty: Key: Elevation, DisplayName: Elevation, FieldType: String, DefaultValue: , Description: Set elevation
#DesignerProperty: Key: Exact, DisplayName: Exact, FieldType: Boolean, DefaultValue: false , Description: Set exact
#DesignerProperty: Key: ExactActiveClass, DisplayName: ExactActiveClass, FieldType: String, DefaultValue: , Description: Set exact-active-class
#DesignerProperty: Key: Fab, DisplayName: Fab, FieldType: Boolean, DefaultValue: false , Description: Set fab
#DesignerProperty: Key: Fixed, DisplayName: Fixed, FieldType: Boolean, DefaultValue: false , Description: Set fixed
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: , Description: Set height
#DesignerProperty: Key: Icon, DisplayName: Icon, FieldType: Boolean, DefaultValue: false , Description: Set icon
#DesignerProperty: Key: InputValue, DisplayName: InputValue, FieldType: String, DefaultValue: , Description: Set input-value
#DesignerProperty: Key: Large, DisplayName: Large, FieldType: Boolean, DefaultValue: false , Description: Set large
#DesignerProperty: Key: Left, DisplayName: Left, FieldType: Boolean, DefaultValue: false , Description: Set left
#DesignerProperty: Key: Light, DisplayName: Light, FieldType: Boolean, DefaultValue: false , Description: Set light
#DesignerProperty: Key: Link, DisplayName: Link, FieldType: Boolean, DefaultValue: false , Description: Set link
#DesignerProperty: Key: Loading, DisplayName: Loading, FieldType: Boolean, DefaultValue: false , Description: Set loading
#DesignerProperty: Key: MaxHeight, DisplayName: MaxHeight, FieldType: String, DefaultValue: , Description: Set max-height
#DesignerProperty: Key: MaxWidth, DisplayName: MaxWidth, FieldType: String, DefaultValue: , Description: Set max-width
#DesignerProperty: Key: MinHeight, DisplayName: MinHeight, FieldType: String, DefaultValue: , Description: Set min-height
#DesignerProperty: Key: MinWidth, DisplayName: MinWidth, FieldType: String, DefaultValue: , Description: Set min-width
#DesignerProperty: Key: Nuxt, DisplayName: Nuxt, FieldType: Boolean, DefaultValue: false , Description: Set nuxt
#DesignerProperty: Key: Outlined, DisplayName: Outlined, FieldType: Boolean, DefaultValue: false , Description: Set outlined
#DesignerProperty: Key: Replace, DisplayName: Replace, FieldType: Boolean, DefaultValue: false , Description: Set replace
#DesignerProperty: Key: RetainFocusOnClick, DisplayName: RetainFocusOnClick, FieldType: Boolean, DefaultValue: false , Description: Set retain-focus-on-click
#DesignerProperty: Key: Right, DisplayName: Right, FieldType: Boolean, DefaultValue: false , Description: Set right
#DesignerProperty: Key: Rounded, DisplayName: Rounded, FieldType: Boolean, DefaultValue: false , Description: Set rounded
#DesignerProperty: Key: Small, DisplayName: Small, FieldType: Boolean, DefaultValue: false , Description: Set small
#DesignerProperty: Key: Tag, DisplayName: Tag, FieldType: String, DefaultValue: , Description: Set tag
#DesignerProperty: Key: Target, DisplayName: Target, FieldType: String, DefaultValue: , Description: Set target
#DesignerProperty: Key: Text, DisplayName: Text, FieldType: Boolean, DefaultValue: false , Description: Set text
#DesignerProperty: Key: Tile, DisplayName: Tile, FieldType: Boolean, DefaultValue: false , Description: Set tile
#DesignerProperty: Key: Top, DisplayName: Top, FieldType: Boolean, DefaultValue: false , Description: Set top
#DesignerProperty: Key: Type, DisplayName: Type, FieldType: String, DefaultValue: , Description: Set type
#DesignerProperty: Key: Value, DisplayName: Value, FieldType: String, DefaultValue: , Description: Set value
#DesignerProperty: Key: Width, DisplayName: Width, FieldType: String, DefaultValue: , Description: Set width
#DesignerProperty: Key: XLarge, DisplayName: XLarge, FieldType: Boolean, DefaultValue: false , Description: Set x-large
#DesignerProperty: Key: XSmall, DisplayName: XSmall, FieldType: Boolean, DefaultValue: false , Description: Set x-small
#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag. 
#DesignerProperty: Key: Style, DisplayName: Style, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String. 
#DesignerProperty: Key: MarginLeft, DisplayName: Margin Left, FieldType: String, DefaultValue: , Description: Margin Left 
#DesignerProperty: Key: MarginRight, DisplayName: Margin Right, FieldType: String, DefaultValue: , Description: Margin Right 
#DesignerProperty: Key: MarginTop, DisplayName: Margin Top, FieldType: String, DefaultValue: , Description: Margin Top 
#DesignerProperty: Key: MarginBottom, DisplayName: Margin Bottom, FieldType: String, DefaultValue: , Description: Margin Bottom 
#DesignerProperty: Key: PaddingLeft, DisplayName: Padding Left, FieldType: String, DefaultValue: , Description: Padding Left 
#DesignerProperty: Key: PaddingRight, DisplayName: Padding Right, FieldType: String, DefaultValue: , Description: Padding Right 
#DesignerProperty: Key: PaddingTop, DisplayName: Padding Top, FieldType: String, DefaultValue: , Description: Padding Top 
#DesignerProperty: Key: PaddingBottom, DisplayName: Padding Bottom, FieldType: String, DefaultValue: , Description: Padding Bottom

Sub Class_Globals
	Private BANano As BANano 'ignore
	Public mName As String 'ignore
	Private mEventName As String 'ignore
	Private mCallBack As Object 'ignore
	Private mTarget As BANanoElement 'ignore
	Private mElement As BANanoElement 'ignore

	Private mClasses As String = ""
	Private mStyle As String = ""
	Public MarginLeft As String = ""
	Public MarginRight As String = ""
	Public MarginTop As String = ""
	Public MarginBottom As String = ""
	Public PaddingLeft As String = ""
	Public PaddingRight As String = ""
	Public PaddingTop As String = ""
	Public PaddingBottom As String = ""

	Private mText As String = ""
	Private mTagName As String = "v-btn"
	Private mVModel As String = ""
	Private mRefName As String = ""
	Private mKeyName As String = ""
	Private mVText As String = ""
	Private mVIf As String = ""
	Private mVElse As String = ""
	Private mVShow As String = ""
	Private mVHtml As String = ""
	Private mVFor As String = ""
	Private Attributes as StringBuilder
	Public bindings As Map
	Public methods As Map
	Public bAbsolute As Boolean = false
	Public sActiveClass As String = ""
	Public bAppend As Boolean = false
	Public bBlock As Boolean = false
	Public bBottom As Boolean = false
	Public sColor As String = ""
	Public bDark As Boolean = false
	Public bDepressed As Boolean = false
	Public bDisabled As Boolean = false
	Public sElevation As String = ""
	Public bExact As Boolean = false
	Public sExactActiveClass As String = ""
	Public bFab As Boolean = false
	Public bFixed As Boolean = false
	Public sHeight As String = ""
	Public bIcon As Boolean = false
	Public sInputValue As String = ""
	Public bLarge As Boolean = false
	Public bLeft As Boolean = false
	Public bLight As Boolean = false
	Public bLink As Boolean = false
	Public bLoading As Boolean = false
	Public sMaxHeight As String = ""
	Public sMaxWidth As String = ""
	Public sMinHeight As String = ""
	Public sMinWidth As String = ""
	Public bNuxt As Boolean = false
	Public bOutlined As Boolean = false
	Public bReplace As Boolean = false
	Public bRetainFocusOnClick As Boolean = false
	Public bRight As Boolean = false
	Public bRounded As Boolean = false
	Public bSmall As Boolean = false
	Public sTag As String = "button"
	Public sTarget As String = ""
	Public bText As Boolean = false
	Public bTile As Boolean = false
	Public bTop As Boolean = false
	Public sType As String = "button"
	Public sValue As String = ""
	Public sWidth As String = ""
	Public bXLarge As Boolean = false
	Public bXSmall As Boolean = false

End Sub

Public Sub Initialize (CallBack As Object, Name As String, EventName As String)
	mName = Name
	mEventName = EventName.ToLowerCase
	mCallBack = CallBack
	bindings.Initialize
	methods.Initialize
	Attributes.Initialize
End Sub

' this is the place where you create the view in html and run initialize javascript.  Must be Public!
Public Sub DesignerCreateView (Target As BANanoElement, props As Map)
	mTarget = Target

	If props <> Null Then
		mClasses = props.Get("Classes")
		mStyle = props.Get("Style")
		MarginLeft = props.Get("MarginLeft")
		MarginRight = props.Get("MarginRight")
		MarginTop = props.Get("MarginTop")
		MarginBottom = props.Get("MarginBottom")
		PaddingLeft = props.Get("PaddingLeft")
		PaddingRight = props.Get("PaddingRight")
		PaddingTop = props.Get("PaddingTop")
		PaddingBottom = props.Get("PaddingBottom")
		mText = props.Get("Text")
		mVModel = props.Get("VModel")
		mRefName = props.Get("RefName")
		mKeyName = props.Get("KeyName")
		mVText = props.Get("VText")
		mVIf = props.Get("VIf")
		mVElse = props.Get("VElse")
		mVShow = props.Get("VShow")
		mVHtml = props.Get("VHtml")
		mVFor = props.Get("VFor")
		bAbsolute = props.Get("Absolute")
		sActiveClass = props.Get("ActiveClass")
		bAppend = props.Get("Append")
		bBlock = props.Get("Block")
		bBottom = props.Get("Bottom")
		sColor = props.Get("Color")
		bDark = props.Get("Dark")
		bDepressed = props.Get("Depressed")
		bDisabled = props.Get("Disabled")
		sElevation = props.Get("Elevation")
		bExact = props.Get("Exact")
		sExactActiveClass = props.Get("ExactActiveClass")
		bFab = props.Get("Fab")
		bFixed = props.Get("Fixed")
		sHeight = props.Get("Height")
		bIcon = props.Get("Icon")
		sInputValue = props.Get("InputValue")
		bLarge = props.Get("Large")
		bLeft = props.Get("Left")
		bLight = props.Get("Light")
		bLink = props.Get("Link")
		bLoading = props.Get("Loading")
		sMaxHeight = props.Get("MaxHeight")
		sMaxWidth = props.Get("MaxWidth")
		sMinHeight = props.Get("MinHeight")
		sMinWidth = props.Get("MinWidth")
		bNuxt = props.Get("Nuxt")
		bOutlined = props.Get("Outlined")
		bReplace = props.Get("Replace")
		bRetainFocusOnClick = props.Get("RetainFocusOnClick")
		bRight = props.Get("Right")
		bRounded = props.Get("Rounded")
		bSmall = props.Get("Small")
		sTag = props.Get("Tag")
		sTarget = props.Get("Target")
		bText = props.Get("Text")
		bTile = props.Get("Tile")
		bTop = props.Get("Top")
		sType = props.Get("Type")
		sValue = props.Get("Value")
		sWidth = props.Get("Width")
		bXLarge = props.Get("XLarge")
		bXSmall = props.Get("XSmall")

		AddAttr(Attributes, mVModel, "s", "v-model")
		AddAttr(Attributes, mRefName, "s", "ref")
		AddAttr(Attributes, mKeyName, "s", "key")
		AddAttr(Attributes, mVText, "s", "v-text")
		AddAttr(Attributes, mVIf, "s", "v-if")
		AddAttr(Attributes, mVElse, "s", "v-else")
		AddAttr(Attributes, mVShow, "s", "v-show")
		AddAttr(Attributes, mVHtml, "s", "v-html")
		AddAttr(Attributes, mVFor, "s", "v-for")
		AddAttr(Attributes, bAbsolute, "b", "absolute")
		AddAttr(Attributes, sActiveClass, "s", "active-class")
		AddAttr(Attributes, bAppend, "b", "append")
		AddAttr(Attributes, bBlock, "b", "block")
		AddAttr(Attributes, bBottom, "b", "bottom")
		AddAttr(Attributes, sColor, "s", "color")
		AddAttr(Attributes, bDark, "b", "dark")
		AddAttr(Attributes, bDepressed, "b", "depressed")
		AddAttr(Attributes, bDisabled, "b", "disabled")
		AddAttr(Attributes, sElevation, "s", "elevation")
		AddAttr(Attributes, bExact, "b", "exact")
		AddAttr(Attributes, sExactActiveClass, "s", "exact-active-class")
		AddAttr(Attributes, bFab, "b", "fab")
		AddAttr(Attributes, bFixed, "b", "fixed")
		AddAttr(Attributes, sHeight, "s", "height")
		AddAttr(Attributes, bIcon, "b", "icon")
		AddAttr(Attributes, sInputValue, "s", "input-value")
		AddAttr(Attributes, bLarge, "b", "large")
		AddAttr(Attributes, bLeft, "b", "left")
		AddAttr(Attributes, bLight, "b", "light")
		AddAttr(Attributes, bLink, "b", "link")
		AddAttr(Attributes, bLoading, "b", "loading")
		AddAttr(Attributes, sMaxHeight, "s", "max-height")
		AddAttr(Attributes, sMaxWidth, "s", "max-width")
		AddAttr(Attributes, sMinHeight, "s", "min-height")
		AddAttr(Attributes, sMinWidth, "s", "min-width")
		AddAttr(Attributes, bNuxt, "b", "nuxt")
		AddAttr(Attributes, bOutlined, "b", "outlined")
		AddAttr(Attributes, bReplace, "b", "replace")
		AddAttr(Attributes, bRetainFocusOnClick, "b", "retain-focus-on-click")
		AddAttr(Attributes, bRight, "b", "right")
		AddAttr(Attributes, bRounded, "b", "rounded")
		AddAttr(Attributes, bSmall, "b", "small")
		AddAttr(Attributes, sTag, "s", "tag")
		AddAttr(Attributes, sTarget, "s", "target")
		AddAttr(Attributes, bText, "b", "text")
		AddAttr(Attributes, bTile, "b", "tile")
		AddAttr(Attributes, bTop, "b", "top")
		AddAttr(Attributes, sType, "s", "type")
		AddAttr(Attributes, sValue, "s", "value")
		AddAttr(Attributes, sWidth, "s", "width")
		AddAttr(Attributes, bXLarge, "b", "x-large")
		AddAttr(Attributes, bXSmall, "b", "x-small")

	End If
	Dim exStyle As String = BuildExStyle
	Dim exAttr As String = Attributes.ToString
	mElement = mTarget.Append($"<${mTagName} id="${mName}" class="${mClasses}" style="${exStyle}${mStyle}" ${exAttr}>${mText}</${mTagName}>"$).Get("#" & mName)

	' defining events is very simple. Note that it has to be run AFTER adding it to the HTML DOM! eventName must be lowercase!

	SetOnClick


End Sub

'set absolute
Sub SetAbsolute(varAbsolute As Boolean)
	bAbsolute = varAbsolute
	mElement.SetAttr("absolute", bAbsolute)
End Sub

'set active-class
Sub SetActiveClass(varActiveClass As String)
	sActiveClass = varActiveClass
	mElement.SetAttr("active-class", sActiveClass)
End Sub

'set append
Sub SetAppend(varAppend As Boolean)
	bAppend = varAppend
	mElement.SetAttr("append", bAppend)
End Sub

'set block
Sub SetBlock(varBlock As Boolean)
	bBlock = varBlock
	mElement.SetAttr("block", bBlock)
End Sub

'set bottom
Sub SetBottom(varBottom As Boolean)
	bBottom = varBottom
	mElement.SetAttr("bottom", bBottom)
End Sub

'set color
Sub SetColor(varColor As String)
	sColor = varColor
	mElement.SetAttr("color", sColor)
End Sub

'set dark
Sub SetDark(varDark As Boolean)
	bDark = varDark
	mElement.SetAttr("dark", bDark)
End Sub

'set depressed
Sub SetDepressed(varDepressed As Boolean)
	bDepressed = varDepressed
	mElement.SetAttr("depressed", bDepressed)
End Sub

'set disabled
Sub SetDisabled(varDisabled As Boolean)
	bDisabled = varDisabled
	mElement.SetAttr("disabled", bDisabled)
End Sub

'set elevation
Sub SetElevation(varElevation As String)
	sElevation = varElevation
	mElement.SetAttr("elevation", sElevation)
End Sub

'set exact
Sub SetExact(varExact As Boolean)
	bExact = varExact
	mElement.SetAttr("exact", bExact)
End Sub

'set exact-active-class
Sub SetExactActiveClass(varExactActiveClass As String)
	sExactActiveClass = varExactActiveClass
	mElement.SetAttr("exact-active-class", sExactActiveClass)
End Sub

'set fab
Sub SetFab(varFab As Boolean)
	bFab = varFab
	mElement.SetAttr("fab", bFab)
End Sub

'set fixed
Sub SetFixed(varFixed As Boolean)
	bFixed = varFixed
	mElement.SetAttr("fixed", bFixed)
End Sub

'set height
Sub SetHeight(varHeight As String)
	sHeight = varHeight
	mElement.SetAttr("height", sHeight)
End Sub

'set href
Sub SetHref(varHref As Object)
	mElement.SetAttr("href", varHref)
End Sub

'set icon
Sub SetIcon(varIcon As Boolean)
	bIcon = varIcon
	mElement.SetAttr("icon", bIcon)
End Sub

'set input-value
Sub SetInputValue(varInputValue As String)
	sInputValue = varInputValue
	mElement.SetAttr("input-value", sInputValue)
End Sub

'set large
Sub SetLarge(varLarge As Boolean)
	bLarge = varLarge
	mElement.SetAttr("large", bLarge)
End Sub

'set left
Sub SetLeft(varLeft As Boolean)
	bLeft = varLeft
	mElement.SetAttr("left", bLeft)
End Sub

'set light
Sub SetLight(varLight As Boolean)
	bLight = varLight
	mElement.SetAttr("light", bLight)
End Sub

'set link
Sub SetLink(varLink As Boolean)
	bLink = varLink
	mElement.SetAttr("link", bLink)
End Sub

'set loading
Sub SetLoading(varLoading As Boolean)
	bLoading = varLoading
	mElement.SetAttr("loading", bLoading)
End Sub

'set max-height
Sub SetMaxHeight(varMaxHeight As String)
	sMaxHeight = varMaxHeight
	mElement.SetAttr("max-height", sMaxHeight)
End Sub

'set max-width
Sub SetMaxWidth(varMaxWidth As String)
	sMaxWidth = varMaxWidth
	mElement.SetAttr("max-width", sMaxWidth)
End Sub

'set min-height
Sub SetMinHeight(varMinHeight As String)
	sMinHeight = varMinHeight
	mElement.SetAttr("min-height", sMinHeight)
End Sub

'set min-width
Sub SetMinWidth(varMinWidth As String)
	sMinWidth = varMinWidth
	mElement.SetAttr("min-width", sMinWidth)
End Sub

'set nuxt
Sub SetNuxt(varNuxt As Boolean)
	bNuxt = varNuxt
	mElement.SetAttr("nuxt", bNuxt)
End Sub

'set outlined
Sub SetOutlined(varOutlined As Boolean)
	bOutlined = varOutlined
	mElement.SetAttr("outlined", bOutlined)
End Sub

'set replace
Sub SetReplace(varReplace As Boolean)
	bReplace = varReplace
	mElement.SetAttr("replace", bReplace)
End Sub

'set retain-focus-on-click
Sub SetRetainFocusOnClick(varRetainFocusOnClick As Boolean)
	bRetainFocusOnClick = varRetainFocusOnClick
	mElement.SetAttr("retain-focus-on-click", bRetainFocusOnClick)
End Sub

'set right
Sub SetRight(varRight As Boolean)
	bRight = varRight
	mElement.SetAttr("right", bRight)
End Sub

'set ripple
Sub SetRipple(varRipple As Object)
	mElement.SetAttr("ripple", varRipple)
End Sub

'set rounded
Sub SetRounded(varRounded As Boolean)
	bRounded = varRounded
	mElement.SetAttr("rounded", bRounded)
End Sub

'set small
Sub SetSmall(varSmall As Boolean)
	bSmall = varSmall
	mElement.SetAttr("small", bSmall)
End Sub

'set tag
Sub SetTag(varTag As String)
	sTag = varTag
	mElement.SetAttr("tag", sTag)
End Sub

'set target
Sub SetTarget(varTarget As String)
	sTarget = varTarget
	mElement.SetAttr("target", sTarget)
End Sub

'set text
Sub SetText(varText As Boolean)
	bText = varText
	mElement.SetAttr("text", bText)
End Sub

'set tile
Sub SetTile(varTile As Boolean)
	bTile = varTile
	mElement.SetAttr("tile", bTile)
End Sub

'set to
Sub SetTo(varTo As Object)
	mElement.SetAttr("to", varTo)
End Sub

'set top
Sub SetTop(varTop As Boolean)
	bTop = varTop
	mElement.SetAttr("top", bTop)
End Sub

'set type
Sub SetType(varType As String)
	sType = varType
	mElement.SetAttr("type", sType)
End Sub

'set value
Sub SetValue(varValue As String)
	sValue = varValue
	mElement.SetAttr("value", sValue)
End Sub

'set width
Sub SetWidth(varWidth As String)
	sWidth = varWidth
	mElement.SetAttr("width", sWidth)
End Sub

'set x-large
Sub SetXLarge(varXLarge As Boolean)
	bXLarge = varXLarge
	mElement.SetAttr("x-large", bXLarge)
End Sub

'set x-small
Sub SetXSmall(varXSmall As Boolean)
	bXSmall = varXSmall
	mElement.SetAttr("x-small", bXSmall)
End Sub


'set on click event
Sub SetOnClick
	Dim mName As String = $"${mEventName}_click"$
	mName = mName.tolowercase
	If SubExists(mCallBack, mName) = False Then Return
	SetAttr("v-on:click", mName)
	Dim argument As BANanoEvent 'ignore
	Dim cb As BANanoObject = BANano.CallBack(mCallBack, mName, Array(argument))
	methods.Put(mName, cb)
End Sub



'add component to parent
public Sub AddToParent(targetID As String)
	mTarget = BANano.GetElement("#" & targetID.ToLowerCase)
	DesignerCreateView(mTarget, Null)
End Sub

'remove component
public Sub Remove()
	mTarget.Empty
	BANano.SetMeToNull
End Sub

'trigger an event
public Sub Trigger(event As String, params() As String)
	If mElement <> Null Then
		mElement.Trigger(event, params)
	End If
End Sub

'set an event
Sub SetVOn(event As String)
	Dim methodName As String = BANanoSnippets.BeautifyName(event)
	methodName = $"${mEventName}_${methodName}"$
	methodName = methodName.tolowercase
	If SubExists(mCallBack, methodName) = False Then Return
	SetAttr($"v-on:${event}"$, methodName)
	SetMethod(mCallBack, methodName)
End Sub

Sub SetVFor(vfor As String)
	mVFor = vfor
	mElement.SetAttr("v-for", mVFor)
End Sub

Sub SetVHtml(vhtml As String)
	mVHtml = vhtml
	mVHtml = BANano.SF(mVHtml)
	mElement.SetAttr("v-html", mVHtml)
End Sub

Sub SetVShow(vshow As String)
	mVShow = vshow
	mElement.SetAttr("v-show", vshow)
End Sub

Sub SetVIf(vif As String)
	mVIf = vif
	mElement.SetAttr("v-if", mVIf)
End Sub

Sub SetVElse(velse As String)
	mVElse = velse
	mElement.SetAttr("v-else", mVElse)
End Sub

Sub SetVText(vtext As String)
	mVText = vtext
	mElement.SetAttr("v-text", mVText)
End Sub

Sub SetKey(skey As String)
	mKeyName = skey
	mElement.SetAttr("key", skey)
End Sub

Sub SetRef(ref As String)
	mRefName = ref
	mElement.SetAttr("ref", ref)
End Sub

Sub SetVModel(vmodel As String)
	mVModel = vmodel
	mElement.SetAttr("v-model", vmodel)
End Sub

'will add properties to attributes, s for strings an b for booleans
private Sub AddAttr(sbx As StringBuilder, varName As String, varType As String, actProp As String)
	Select Case varType
		Case "b"
			If varName <> "" Then sbx.append($"${actProp}=${varName} "$)
		Case "s"
			If varName <> "" Then sbx.append($"${actProp}="${varName}" "$)
	End Select
End Sub

'build styles
private Sub BuildExStyle() As String
	Dim sb As StringBuilder
	sb.Initialize
	If MarginLeft <> "" Then sb.Append("margin-left: " & MarginLeft & ";")
	If MarginRight <> "" Then sb.Append("margin-right: " & MarginRight & ";")
	If MarginTop <> "" Then sb.Append("margin-top: " & MarginTop & ";")
	If MarginBottom <> "" Then sb.Append("margin-bottom: " & MarginBottom & ";")
	If PaddingLeft <> "" Then sb.Append("padding-left: " & PaddingLeft & ";")
	If PaddingRight <> "" Then sb.Append("padding-right: " & PaddingRight & ";")
	If PaddingTop <> "" Then sb.Append("padding-top: " & PaddingTop & ";")
	If PaddingBottom <> "" Then sb.Append("padding-bottom: " & PaddingBottom & ";")
	Return sb.ToString
End Sub

#Region Property Getters and Setters
public Sub SetClasses(Classes As String)
	If mElement <> Null Then
		mElement.AddClass(Classes)
	End If
	mClasses = Classes
End Sub

public Sub GetClasses() As String
	Return mClasses
End Sub

' must be a json string
' e.g. $"{ "width": "200px", "height": "200px", "background": "green", "border-radius": "5px" }"$
public Sub SetStyle(Style As String)
	If mElement <> Null Then
		mElement.SetStyle(Style)
	End If
	mStyle = Style
End Sub

'add a list of classes
Sub AddClass(classNames As List)
	For Each k As String In classNames
		mElement.AddClass(k)
	Next
End Sub

'set styles from a map
Sub SetStyles(m As Map)
	Dim jsonStyle As String = BANano.ToJson(m)
	mElement.SetStyle(jsonStyle)
End Sub

'set attributes from a map
Sub SetAttrs(props As Map)
	For Each k As String In props.Keys
		Dim v As String = props.Get(k)
		mElement.SetAttr(k, v)
	Next
End Sub

'set an attribute
Sub SetAttr(prop As String, value As String)
	mElement.SetAttr(prop, value)
End Sub

'stop compilation
Sub SetVPre
	mElement.SetAttr("v-pre", True)
End Sub

'bind an attribute
Sub SetVBind(prop As String, value As String)
	prop = prop.ToLowerCase
	value = value.ToLowerCase
	prop = $"v-bind:${prop}"$
	mElement.SetAttr(prop,value)
	bindings.Put(value, Null)
End Sub

'set a single style
Sub SetStyleSingle(prop As String, value As String)
	Dim m As Map = CreateMap()
	m.Put(prop, value)
	Dim jsonStyle As String = BANano.ToJson(m)
	mElement.SetStyle(jsonStyle)
End Sub

'build a structure using props, styleprops, classes and loose attributes
Sub Build(props As Map, styleProps As Map, classNames As List, loose As List)
	If loose <> Null Then
		For Each k As String In loose
			mElement.SetAttr(k, True)
		Next
	End If
	If props <> Null Then
		For Each k As String In props.Keys
			Dim v As String = props.Get(k)
			mElement.SetAttr(k, v)
		Next
	End If
	If styleProps <> Null Then
		Dim jsonStyle As String = BANano.ToJson(styleProps)
		mElement.SetStyle(jsonStyle)
	End If
	If classNames <> Null Then
		AddClass(classNames)
	End If
End Sub

'get text
public Sub GetText() As String
	Return mElement.GetText
End Sub

'hide until compilation finishes
Sub SetVCloak
	If mElement <> Null Then
		mElement.SetAttr("v-cloak", True)
	End If
End Sub

'compile once
Sub SetVOnce
	mElement.SetAttr("v-once", True)
End Sub

'get html
Public Sub GetHtml() As String
	Return mElement.GetHtml
End Sub


'set color intensity
Sub SetColorIntensity(varColor As String, varIntensity As String)
	Dim sColor As String = $"${varColor} ${varIntensity}"$
	Dim pp As String = $"${mName}color"$
	mElement.SetAttr(":color", pp)
	'store the bindings
	bindings.Put(pp, sColor)
End Sub

'set text color
Sub SetTextColor(varColor As String)
	Dim sColor As String = $"${varColor}--text"$
	mElement.AddClass(sColor)
End Sub

'set text color intensity
Sub SetTextColorIntensity(varColor As String, varIntensity As String)
	Dim sColor As String = $"${varColor}--text"$
	Dim sIntensity As String = $"text--${varIntensity}"$
	Dim mcolor As String = $"${sColor} ${sIntensity}"$
	mElement.AddClass(mcolor)
End Sub


'set direct method
Sub SetMethod(Module As Object,methodName As String) 
	methodName = methodName.ToLowerCase
	If SubExists(Module, methodName) Then
		Dim e As BANanoEvent
		Dim cb As BANanoObject = BANano.CallBack(Module, methodName, Array(e))
		methods.Put(methodName, cb)
	End If
End Sub
